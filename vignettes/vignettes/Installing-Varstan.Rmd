---
title: "Installing-varstan"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Installing-Varstan}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

### Introduction

Varstan is a package for analyze time series with common structured models such as arima, garch, var, bekk, SVM, HMM, ETS and others. On this beta version the models varbekk and varbekkM(1) are currently available.

The dynamic is, first to create the model structure using a constructure, then define the prior parameters, next call the varstan function to estimate the chosen model in a bayesian scheme using STAN. Finally the summary, point\_estimate, model\_diagnostic, forecast functions are used to evaluate the obtained results.

The posterior distribution is approimated using a Hamiltonian monte carlo, using the stan using the r package rstan.


## Installing Rstan in r

To be on the safe side, it is sometimes necessary to remove any existing RStan via


```{r,eval=FALSE}
remove.packages("rstan")
if (file.exists(".RData")) file.remove(".RData")
```

Then, restart R.

In most cases, you can simply type (exactly like this)


```{r,eval=FALSE}
install.packages("rstan", repos = "https://cloud.r-project.org/", dependencies = TRUE)
```

For more details check the next link [rstan](https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started)


### Checking the C++ Toolchain

In RStudio (preferably) or otherwise in R, execute once

```{r,eval=FALSE}
pkgbuild::has_build_tools(debug = TRUE)
```

to check your C++ toolchain using the pkgbuild package that gets installed when you install RStan. If this line ultimately returns TRUE, then your C++ toolchain is properly installed. If you get the option **FALSE** then read the section **Checking the C++ Toolchain** in [rstan](https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started)

### Troubleshooting Rstan / Rtools install for Windows:

Ensure recent version of R and Rtools is installed.

try including these lines in home/.R/makevars. :

    CXX14 = g++ -std=c++1y
    CXX14FLAGS = -O3 -Wno-unused-variable -Wno-unused-function

If makevars script does not exist in the .R file or you want to update it, run this code within R:

```{r,eval=FALSE}
dotR <- file.path(Sys.getenv("HOME"), ".R")
if (!file.exists(dotR)) dir.create(dotR)
M <- file.path(dotR, ifelse(.Platform$OS.type == "windows", "Makevars.win", "Makevars"))
if (!file.exists(M)){
  file.create(M) 
    cat("\nCXX14FLAGS=-O3 -march=native -mtune=native",
    if( grepl("^darwin", R.version$os)) "CXX14FLAGS += -arch x86_64 -ftemplate-depth-256" else 
     if (.Platform$OS.type == "windows") "CXX11FLAGS=-O3 -march=native -mtune=native" else "CXX14FLAGS += -fPIC",
     if (.Platform$OS.type == "windows") "CXX11FLAGS=-O3 -mtune=native CXX14 = $(BINPREF)g++ -m$(WIN) -std=c++1y" else "CXX14FLAGS += -fPIC",
     if (.Platform$OS.type == "windows") "CXX14 = g++ -std=c++1y" else "CXX14FLAGS += -fPIC",
     if (.Platform$OS.type == "windows") "CXX14FLAGS = -O3 -Wno-unused-variable -Wno-unused-function" else "CXX14FLAGS += -fPIC",
    file = M, sep = "\n", append = TRUE)
} 
rm(dotR,M)
```    
The makevars script in *C:\Users\user\Documents\.R* looks  like this:

```{r,echo=FALSE}
cat("CXX14FLAGS=-O3 -march=native -mtune=native",
"CXX11FLAGS=-O3 -march=native -mtune=native",
"CXX11FLAGS=-O3 -mtune=native CXX14 = $(BINPREF)g++ -m$(WIN) -std=c++1y",
"CXX14 = g++ -std=c++1y",
"CXX14FLAGS = -O3 -Wno-unused-variable -Wno-unused-function",sep="\n")
```


Make shure your file looks similar to the one above.

### Install varstan from git

For avoiding package installing problems, make shure you have updated the next packages: **devtools,pkgbuild,remotes,StanHeaders,OpenMx**.If you are not shure about it, compile the code bellow 

```{r,eval=FALSE}
packs <- c('devtools','pkgbuild','remotes','StanHeaders','OpenMx','rstantools')
install.packages(packs,dependencies = TRUE)
rm(packs)
```

Finally installing varstan package for git use the next code:

```{r,eval=FALSE}

library(devtools)

remove.packages("varstan")
if (file.exists(".RData")) file.remove(".RData")

Sys.setenv(PATH = paste("C:/Rtools/bin", Sys.getenv("PATH"), sep=";"))
Sys.setenv(PATH = paste("C:\\Rtools\\mingw_64\\bin", Sys.getenv("PATH"), sep=";"))
Sys.setenv(BINPREF = "C:/Rtools/mingw_$(WIN)/bin/")

install_github("asael697/varstan", upgrade='never',INSTALL_opts = "--no-multiarch", dependencies = c("Depends", "Imports"))
```


 
